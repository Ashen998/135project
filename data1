```{r,echo = F}
rawdata <- read.csv("C://Users//zhoug//Downloads//Birthweight_reduced_kg_R.csv")
ncol(rawdata)

#discarding categorical variable(I also discard the "ID" collumn as I think it can be meaningless)
#(we can also drop the "length","head circumference" of babies and "gestation" if we want to discuss the effect mainly by smoking)
#(or we can use them same as birthweight as a dependant variable)
smbb = subset(rawdata,select = -c(ID,smoker,lowbwt,mage35)) 
head(smbb)

#Finding standing out individuals(outliers)
find_outliers <- function(input,cols = names(input)){
  for(col in cols){
    out = boxplot.stats(input[[col]])$out
    print(col)
    print(which(input[[col]] %in% out))
  }
}
find_outliers(smbb)
#the 3rd, 20th and 28th are outliers of Length;
#the 20th and 27th are outliers of Gestation;
#the 42nd, 35th and 36th are respectively outliers of mnocig, mheight and fage
#Trying to use star plot
stars(smbb)
#(we can discuss here which one seems different than the others)

#Using correlation matrix will standardize variables, so we tend to use it when variable scales are not silmilar.
#On the contrary, when the scales are similar, we prefer the covariance one.

pca1 = prcomp(smbb,scale = T)
summary(pca1)
#we need at least 5 PCs to explain 80% of the data variance
biplot(pca1)
#headcirc as PC1, and mnocig as PC2
```
